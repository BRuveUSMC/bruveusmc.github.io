<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: https://fonts.googleapis.com https://fonts.gstatic.com;">
<title>Constellation</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:#000;color:#fff;overflow:hidden;height:100vh;font-weight:300;letter-spacing:0.5px;-webkit-app-region:no-drag}.bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;transition:all 1s ease-in-out}#audio-start{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:1000;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:opacity 0.5s ease-in-out}#audio-start h2{font-size:2rem;font-weight:300;letter-spacing:4px;text-transform:uppercase;opacity:0.8;animation:pulse 2s ease-in-out infinite}@keyframes pulse{0%,100%{opacity:0.5}50%{opacity:1}}#m{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;z-index:100;background:rgba(0,0,0,0.95);padding:60px 80px;border:1px solid #333;border-radius:2px;backdrop-filter:blur(20px)}h1{font-size:3rem;margin-bottom:2rem;color:#fff;font-weight:300;letter-spacing:8px;text-transform:uppercase}.btn{background:#000;color:#fff;border:1px solid #fff;padding:16px 32px;margin:8px;border-radius:0;cursor:pointer;transition:all 0.3s ease;font-family:inherit;font-weight:300;letter-spacing:2px;text-transform:uppercase;font-size:14px}.btn:hover{background:#fff;color:#000;transform:translateY(-2px);box-shadow:0 8px 25px rgba(255,255,255,0.1)}#ui{position:fixed;top:30px;left:30px;z-index:50;font-size:13px;font-weight:400;display:none}.ui{background:rgba(0,0,0,0.9);border:1px solid #333;padding:12px 20px;margin:8px 0;border-radius:0;color:#fff;letter-spacing:1px;text-transform:uppercase;backdrop-filter:blur(10px)}#settings-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:150;display:none;backdrop-filter:blur(5px)}#settings-panel{position:fixed;top:0;right:0;width:320px;height:100%;background:rgba(0,0,0,0.95);border-left:1px solid #333;z-index:160;transform:translateX(100%);transition:transform 0.3s ease-in-out;backdrop-filter:blur(20px)}.settings-header{padding:30px 20px 20px;border-bottom:1px solid #333;font-size:18px;font-weight:300;letter-spacing:2px;text-transform:uppercase}.settings-content{padding:20px}.settings-item{margin-bottom:20px}.settings-label{display:block;font-size:12px;font-weight:400;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;opacity:0.8}.settings-button{background:#000;color:#fff;border:1px solid #333;padding:12px 20px;width:100%;cursor:pointer;font-family:inherit;font-weight:300;letter-spacing:1px;text-transform:uppercase;font-size:12px;transition:all 0.3s ease}.settings-button:hover{background:#fff;color:#000}.settings-button.danger{border-color:#ff4444;color:#ff4444}.settings-button.danger:hover{background:#ff4444;color:#fff}.settings-close{position:absolute;top:20px;right:20px;background:none;border:none;color:#fff;font-size:24px;cursor:pointer;opacity:0.6;transition:opacity 0.3s ease}.settings-close:hover{opacity:1}#s{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:30px 50px;border:1px solid #fff;border-radius:0;display:none;z-index:60;font-size:16px;font-weight:300;letter-spacing:2px;text-transform:uppercase;backdrop-filter:blur(20px)}#credits-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:200;display:none;overflow:hidden;backdrop-filter:blur(5px)}#credits-scroll{position:absolute;left:50%;transform:translateX(-50%);width:600px;text-align:center;animation:scrollUp 60s linear forwards}@keyframes scrollUp{from{top:100vh}to{top:-1800px}}.credits-section{margin:120px 0}.credits-title{font-size:24px;color:#fff;font-weight:500;letter-spacing:3px;text-transform:uppercase;margin-bottom:20px;text-shadow:0 0 10px rgba(255,255,255,0.3)}.credits-name{font-size:32px;color:#fff;font-weight:300;letter-spacing:4px;margin:10px 0;text-shadow:0 0 20px rgba(255,255,255,0.5)}.credits-final{font-size:48px;color:#fff;font-weight:700;letter-spacing:8px;text-transform:uppercase;text-shadow:0 0 30px rgba(255,255,255,0.8);margin:100px 0}.credits-close{position:absolute;top:30px;right:30px;background:rgba(0,0,0,0.9);border:1px solid #fff;color:#fff;padding:12px 24px;cursor:pointer;font-family:inherit;font-weight:300;letter-spacing:2px;text-transform:uppercase;font-size:12px;transition:all 0.3s ease}.credits-close:hover{background:#fff;color:#000}.exit-hint{position:fixed;top:10px;right:10px;font-size:10px;opacity:0.3;z-index:1001;color:#fff;pointer-events:none;transition:opacity 0.3s ease}.exit-hint:hover{opacity:0.7}#c{width:100%;height:100vh;position:relative;cursor:crosshair}.st{position:absolute;width:6px;height:6px;background:#fff;border-radius:50%;opacity:0.7;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);cursor:pointer;transform:translate(-50%,-50%);border:1px solid rgba(255,255,255,0.3)}.st.a{opacity:1;transform:translate(-50%,-50%) scale(3);background:#fff;box-shadow:0 0 30px rgba(255,255,255,0.8),0 0 60px rgba(255,255,255,0.4);border:1px solid #fff}.st.e{background:#fff !important;opacity:0.3 !important;animation:flash 0.5s ease-in-out}@keyframes flash{0%,100%{opacity:0.3}50%{opacity:1;background:#fff}}.ln{position:absolute;height:1px;background:linear-gradient(90deg,#fff,rgba(255,255,255,0.3));opacity:0.8;transform-origin:left center;animation:drawLine 0.6s ease-out}@keyframes drawLine{from{width:0;opacity:0}to{opacity:0.8}}.star{position:absolute;border-radius:50%;pointer-events:none}.star-micro{width:0.5px;height:0.5px;background:#fff;opacity:0.3;animation:twinkle-micro 4s ease-in-out infinite}.star-tiny{width:1px;height:1px;background:#fff;opacity:0.5;animation:twinkle-tiny 3s ease-in-out infinite}.star-small{width:1.5px;height:1.5px;background:#fff;opacity:0.7;animation:twinkle-small 2.5s ease-in-out infinite}.star-medium{width:2px;height:2px;background:#fff;opacity:0.8;animation:twinkle-medium 2s ease-in-out infinite;box-shadow:0 0 2px rgba(255,255,255,0.3)}.star-large{width:3px;height:3px;background:#fff;opacity:0.9;animation:twinkle-large 1.5s ease-in-out infinite;box-shadow:0 0 4px rgba(255,255,255,0.5)}.star-bright{width:2.5px;height:2.5px;background:#fff;opacity:1;animation:twinkle-bright 1s ease-in-out infinite;box-shadow:0 0 6px rgba(255,255,255,0.8),0 0 12px rgba(255,255,255,0.3)}.star-colored{animation-duration:3s}.star-blue{background:#87ceeb;box-shadow:0 0 4px rgba(135,206,235,0.4)}.star-red{background:#ffb6c1;box-shadow:0 0 4px rgba(255,182,193,0.4)}.star-yellow{background:#fff8dc;box-shadow:0 0 4px rgba(255,248,220,0.4)}.star-orange{background:#ffa500;box-shadow:0 0 4px rgba(255,165,0,0.4)}@keyframes twinkle-micro{0%,100%{opacity:0.1}50%{opacity:0.3}}@keyframes twinkle-tiny{0%,100%{opacity:0.3}50%{opacity:0.5}}@keyframes twinkle-small{0%,100%{opacity:0.4}50%{opacity:0.7}}@keyframes twinkle-medium{0%,100%{opacity:0.6}50%{opacity:0.8}}@keyframes twinkle-large{0%,100%{opacity:0.7}50%{opacity:0.9}}@keyframes twinkle-bright{0%,100%{opacity:0.8;transform:scale(1)}25%{opacity:1;transform:scale(1.2)}75%{opacity:1;transform:scale(0.9)}}.nebula{position:absolute;border-radius:50%;filter:blur(40px);animation:nebulaPulse 8s ease-in-out infinite;pointer-events:none}@keyframes nebulaPulse{0%,100%{opacity:0.1;transform:scale(1)}50%{opacity:0.3;transform:scale(1.2)}}
</style>
</head>
<body>
<div class="exit-hint">Press ESC for settings</div>
<div id="audio-start"><h2>Click anywhere to start</h2></div>
<div class="bg" id="bg"></div>
<div id="m"><h1>Constellation</h1><button class="btn" onclick="start()">Begin</button><br><button class="btn" onclick="showCredits()">Credits</button></div>
<div id="ui"><div class="ui">Level <span id="l">1</span></div></div>
<div id="s"></div>
<div id="c"></div>

<div id="settings-overlay">
<div id="settings-panel">
<button class="settings-close" onclick="hideSettings()">Ã—</button>
<div class="settings-header">Settings</div>
<div class="settings-content">
<div class="settings-item">
<label class="settings-label">Game Options</label>
<button class="settings-button" onclick="restartGame()">Restart Game</button>
</div>
<div class="settings-item">
<label class="settings-label">Display</label>
<button class="settings-button" onclick="toggleFullscreen()">Toggle Fullscreen</button>
</div>
<div class="settings-item">
<label class="settings-label">Audio</label>
<button class="settings-button" onclick="toggleSound()">Toggle Sound</button>
</div>
<div class="settings-item">
<button class="settings-button" onclick="saveProgress()">Save Progress</button>
</div>
<div class="settings-item">
<button class="settings-button" onclick="returnToMenu()">Return to Menu</button>
</div>
<div class="settings-item">
<label class="settings-label">Exit Game</label>
<button class="settings-button danger" onclick="saveAndExit()">Save & Exit</button>
</div>
</div>
</div>
</div>

<div id="credits-overlay">
<button class="credits-close" onclick="hideCredits()">Close</button>
<div id="credits-scroll">
<div class="credits-section"><div class="credits-title">Game Design</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Programming</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Art Direction</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Visual Effects</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Sound Design</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Music Composition</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">User Interface</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Animation</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Level Design</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Quality Assurance</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Project Management</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-title">Special Thanks</div><div class="credits-name">Jaxon Whitehouse</div></div>
<div class="credits-section"><div class="credits-final">Memory Constellation</div><div class="credits-name">Created by Jaxon Whitehouse</div></div>
</div>
</div>

<script>
const isE=typeof require!=='undefined';let ipc=null;if(isE){try{ipc=require('electron').ipcRenderer;}catch(e){}}
let g={l:1,st:[],sq:[],ps:[],sh:false,on:false,ln:[],se:true},c=document.getElementById('c'),u={l:document.getElementById('l'),s:document.getElementById('s')},a={t:[],i:0,au:null,v:0.3},sf;
try{sf=new Audio('button.wav');sf.volume=0.7;}catch(e){sf=null;}
function ps(){if(!g.se)return;try{if(sf){sf.currentTime=0;sf.play();}}catch(e){}}
async function lm(){try{const r=await fetch('music.json'),d=await r.json();a.t=d.tracks;a.v=d.volume||0.3;a.au=new Audio();a.au.volume=a.v;a.au.addEventListener('ended',nt);a.au.addEventListener('error',nt);pt();}catch(e){}}
function pt(){if(!a.t.length||!g.se)return;try{a.au.src=a.t[a.i].url;a.au.play().catch(nt);}catch(e){nt();}}
function nt(){a.i=(a.i+1)%a.t.length;pt();}
document.getElementById('audio-start').addEventListener('click',function(){ps();this.style.opacity='0';setTimeout(()=>this.style.display='none',500);lm();});
function cs(){const b=document.getElementById('bg'),p=['radial-gradient(circle at 20% 30%, rgba(138, 43, 226, 0.3) 0%, rgba(25, 25, 112, 0.1) 40%, rgba(0,0,0,1) 70%), radial-gradient(circle at 80% 20%, rgba(72, 61, 139, 0.2) 0%, transparent 50%)','radial-gradient(ellipse at 60% 40%, rgba(0, 255, 255, 0.25) 0%, rgba(0, 139, 139, 0.15) 35%, rgba(0,0,0,1) 65%), radial-gradient(circle at 30% 70%, rgba(64, 224, 208, 0.1) 0%, transparent 45%)','radial-gradient(circle at 40% 60%, rgba(255, 69, 0, 0.3) 0%, rgba(139, 69, 19, 0.1) 40%, rgba(0,0,0,1) 70%), radial-gradient(circle at 70% 30%, rgba(255, 140, 0, 0.15) 0%, transparent 35%)','radial-gradient(circle at 50% 20%, rgba(50, 205, 50, 0.25) 0%, rgba(34, 139, 34, 0.1) 45%, rgba(0,0,0,1) 75%), radial-gradient(circle at 25% 80%, rgba(124, 252, 0, 0.12) 0%, transparent 40%)','radial-gradient(ellipse at 90% 50%, rgba(255, 20, 147, 0.28) 0%, rgba(199, 21, 133, 0.15) 40%, rgba(0,0,0,1) 70%), radial-gradient(circle at 10% 40%, rgba(255, 105, 180, 0.1) 0%, transparent 45%)','radial-gradient(circle at 30% 80%, rgba(65, 105, 225, 0.3) 0%, rgba(25, 25, 112, 0.1) 50%, rgba(0,0,0,1) 80%), radial-gradient(circle at 75% 25%, rgba(138, 43, 226, 0.15) 0%, transparent 40%)','radial-gradient(ellipse at 70% 60%, rgba(255, 215, 0, 0.2) 0%, rgba(184, 134, 11, 0.1) 35%, rgba(0,0,0,1) 65%), radial-gradient(circle at 20% 30%, rgba(255, 193, 37, 0.12) 0%, transparent 50%)','radial-gradient(circle at 45% 35%, rgba(220, 20, 60, 0.25) 0%, rgba(139, 0, 0, 0.1) 40%, rgba(0,0,0,1) 75%), radial-gradient(circle at 80% 70%, rgba(255, 69, 0, 0.1) 0%, transparent 35%)'];b.style.background=p[g.l%p.length];b.innerHTML='';
const sc={micro:80,tiny:60,small:40,medium:25,large:15,bright:8};const cc=0.15;const co=['blue','red','yellow','orange'];
Object.entries(sc).forEach(([t,n])=>{for(let i=0;i<n;i++){const s=document.createElement('div');s.className=`star star-${t}`;if(Math.random()<cc&&t!=='micro'&&t!=='tiny'){const c=co[Math.floor(Math.random()*co.length)];s.classList.add(`star-${c}`);s.classList.add('star-colored');}s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';s.style.animationDelay=Math.random()*5+'s';if(t==='bright'){s.style.animationDuration=(0.8+Math.random()*0.8)+'s';}b.appendChild(s);}});
if(Math.random()>0.4){const nc=['radial-gradient(circle, rgba(138, 43, 226, 0.15) 0%, transparent 70%)','radial-gradient(circle, rgba(0, 255, 255, 0.12) 0%, transparent 70%)','radial-gradient(circle, rgba(255, 69, 0, 0.18) 0%, transparent 70%)','radial-gradient(circle, rgba(50, 205, 50, 0.14) 0%, transparent 70%)','radial-gradient(circle, rgba(255, 20, 147, 0.16) 0%, transparent 70%)'];for(let i=0;i<Math.random()*3+1;i++){const n=document.createElement('div');n.className='nebula';n.style.left=Math.random()*100+'%';n.style.top=Math.random()*100+'%';n.style.width=Math.random()*300+150+'px';n.style.height=n.style.width;n.style.background=nc[Math.floor(Math.random()*nc.length)];n.style.animationDelay=Math.random()*8+'s';b.appendChild(n);}}}
function showSettings(){if(!g.on)return;ps();const o=document.getElementById('settings-overlay');const p=document.getElementById('settings-panel');o.style.display='block';setTimeout(()=>{p.style.transform='translateX(0)';},10);}
function hideSettings(){ps();const o=document.getElementById('settings-overlay');const p=document.getElementById('settings-panel');p.style.transform='translateX(100%)';setTimeout(()=>{o.style.display='none';},300);}
function restartGame(){ps();hideSettings();g.l=1;nx();}
function toggleFullscreen(){ps();if(!document.fullscreenElement){document.documentElement.requestFullscreen().catch(()=>{});}else{document.exitFullscreen().catch(()=>{});}}
function toggleSound(){ps();g.se=!g.se;if(!g.se&&a.au){a.au.pause();}else if(g.se&&a.au&&a.t.length>0){pt();}}
function saveProgress(){ps();const d={level:g.l,soundEnabled:g.se,timestamp:Date.now()};if(ipc){ipc.send('save-progress',d);}else{localStorage.setItem('constellation-save',JSON.stringify(d));}u.s.textContent='Progress Saved';u.s.style.display='block';setTimeout(()=>u.s.style.display='none',1500);}
function saveAndExit(){ps();const d={level:g.l,soundEnabled:g.se,timestamp:Date.now()};if(ipc){ipc.send('save-progress',d);setTimeout(()=>{ipc.send('save-and-exit');},500);}else{localStorage.setItem('constellation-save',JSON.stringify(d));window.close();}}
function returnToMenu(){ps();hideSettings();g.on=false;document.getElementById('ui').style.display='none';document.getElementById('m').style.display='block';c.innerHTML='';}
if(ipc){ipc.on('progress-saved',(e,r)=>{if(r.success){}});}
let ct=null;
function showCredits(){ps();const co=document.getElementById('credits-overlay'),mm=document.getElementById('m');const w=g.on;mm.style.display='none';co.style.display='block';const scr=document.getElementById('credits-scroll');scr.style.animation='none';scr.offsetHeight;scr.style.animation='scrollUp 60s linear forwards';ct=setTimeout(()=>{hideCredits(w);},62000);}
function hideCredits(rt=false){ps();if(ct){clearTimeout(ct);ct=null;}document.getElementById('credits-overlay').style.display='none';if(rt&&g.on){document.getElementById('ui').style.display='block';}else{document.getElementById('m').style.display='block';}}
function start(){ps();document.getElementById('m').style.display='none';document.getElementById('ui').style.display='block';g.on=true;g.l=1;nx();}
function mk(){c.innerHTML='';g.st=[];g.ln=[];let n=Math.min(3+Math.floor(g.l/2),8),pd=100;for(let i=0;i<n;i++){let x,y,tr=0;do{x=pd+Math.random()*(innerWidth-2*pd);y=pd+Math.random()*(innerHeight-2*pd);tr++;}while(tr<20&&(y<150&&x<200));let s=document.createElement('div');s.className='st';s.style.left=x+'px';s.style.top=y+'px';let d={e:s,x,y,i};s.onclick=()=>cl(d);g.st.push(d);c.appendChild(s);}}
function gn(){let n=Math.min(3+Math.floor(g.l/3),g.st.length);g.sq=g.st.slice().sort(()=>Math.random()-0.5).slice(0,n);}
function sh(){g.sh=true;g.ps=[];if(g.l===1){u.s.textContent='Observe';u.s.style.display='block';}let d=Math.max(900-g.l*40,500);g.sq.forEach((s,i)=>{setTimeout(()=>{s.e.classList.add('a');setTimeout(()=>{s.e.classList.remove('a');if(i===g.sq.length-1){setTimeout(()=>{g.sh=false;if(g.l===1){u.s.textContent='Replicate';setTimeout(()=>u.s.style.display='none',1800);}},400);}},d*0.7);},i*d);});}
function cl(s){if(g.sh||!g.on)return;ps();if(g.sq[g.ps.length]===s){s.e.classList.add('a');g.ps.push(s);if(g.ps.length>1)ln(g.ps[g.ps.length-2],s);if(g.ps.length===g.sq.length)wn();}else{fl();}}
function ln(s1,s2){let l=document.createElement('div');l.className='ln';let dx=s2.x-s1.x,dy=s2.y-s1.y,le=Math.sqrt(dx*dx+dy*dy),an=Math.atan2(dy,dx)*180/Math.PI;l.style.left=s1.x+'px';l.style.top=s1.y+'px';l.style.width=le+'px';l.style.transform=`rotate(${an}deg)`;g.ln.push(l);c.appendChild(l);}
function wn(){u.s.textContent='Success';u.s.style.display='block';setTimeout(()=>{g.l++;nx();},1800);}
function fl(){u.s.textContent='Failed';u.s.style.display='block';g.st.forEach(s=>s.e.classList.add('e'));setTimeout(()=>{g.st.forEach(s=>s.e.classList.remove('e','a'));g.ln.forEach(l=>l.remove());g.ln=[];setTimeout(()=>{u.s.style.display='none';sh();},600);},1200);}
function nx(){u.s.style.display='none';u.l.textContent=g.l;cs();mk();gn();setTimeout(sh,1000);}
cs();
document.addEventListener('keydown',function(e){if(e.key==='Escape'){if(document.getElementById('credits-overlay').style.display==='block'){hideCredits();}else if(document.getElementById('settings-overlay').style.display==='block'){hideSettings();}else if(g.on){showSettings();}}});
document.querySelectorAll('.btn,.credits-close,.settings-button,.settings-close').forEach(b=>b.addEventListener('click',ps));document.addEventListener('DOMContentLoaded',function(){setTimeout(function(){const eh=document.querySelector('.exit-hint');if(eh)eh.style.opacity='0';},5000);});document.addEventListener('contextmenu',function(e){e.preventDefault();});document.addEventListener('dragover',function(e){e.preventDefault();});document.addEventListener('drop',function(e){e.preventDefault();});
</script>
</body>
</html>